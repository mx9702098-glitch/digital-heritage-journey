<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°å­—é—äº§ç»§æ‰¿ä¹‹æ—…ï¼šå®ˆæŠ¤æœ€åçš„æ•°å­—å°è®°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #fff;
            overflow-x: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 10px 20px;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            padding: 15px 0;
            flex-shrink: 0;
        }

        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 5px;
            background: linear-gradient(45deg, #fff, #a8e6cf);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1rem;
            opacity: 0.8;
            margin-bottom: 10px;
        }

        .stats-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(15px);
            z-index: 1000;
            min-width: 250px;
            border: 1px solid rgba(255,255,255,0.2);
            font-size: 0.85rem;
        }

        .stats-panel h3 {
            margin-bottom: 10px;
            color: #a8e6cf;
            text-align: center;
            font-size: 1rem;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 0.8rem;
            padding: 3px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .journey-map {
            position: relative;
            height: 280px;
            background: linear-gradient(135deg, rgba(30, 60, 114, 0.1), rgba(142, 68, 173, 0.1));
            border-radius: 15px;
            margin: 10px 0;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.1);
            flex-shrink: 0;
        }

        .journey-path {
            position: absolute;
            top: 50%;
            left: 8%;
            right: 8%;
            height: 4px;
            background: linear-gradient(90deg, 
                rgba(255,255,255,0.2) 0%, 
                rgba(255,255,255,0.6) 50%, 
                rgba(255,255,255,0.2) 100%);
            border-radius: 2px;
            transform: translateY(-50%);
            box-shadow: 0 0 8px rgba(255,255,255,0.3);
        }

        .journey-node {
            position: absolute;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 3px solid #fff;
            background: rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.4s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 3px 12px rgba(0,0,0,0.3);
        }

        .journey-node:hover {
            transform: scale(1.1);
            box-shadow: 0 0 25px rgba(255,255,255,0.6);
        }

        .journey-node.active {
            background: linear-gradient(45deg, #F39C12, #E67E22);
            animation: pulse 2s infinite;
            box-shadow: 0 0 20px rgba(243, 156, 18, 0.8);
        }

        .journey-node.visited {
            background: linear-gradient(45deg, #3498DB, #2980B9);
            border-color: #3498DB;
        }

        .journey-node.success {
            background: linear-gradient(45deg, #27AE60, #2ECC71);
        }

        .journey-node.blocked {
            background: linear-gradient(45deg, #95A5A6, #7F8C8D);
        }

        .journey-node.warning {
            background: linear-gradient(45deg, #F1C40F, #F39C12);
        }

        .node-icon {
            font-size: 1.5rem;
            z-index: 2;
        }

        /* å°äººè§’è‰² */
        .character {
            position: absolute;
            width: 60px;
            height: 60px;
            transition: all 1s ease-in-out;
            z-index: 100;
            top: 45%;
            left: 5%;
        }

        .character-avatar {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            animation: bounce 2s infinite;
            box-shadow: 0 3px 12px rgba(0,0,0,0.3);
            border: 3px solid #fff;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            60% { transform: translateY(-4px); }
        }

        /* æƒ…æ„ŸæŒ‡ç¤ºå™¨ */
        .emotional-indicator {
            display: flex;
            justify-content: center;
            margin: 8px 0;
            gap: 10px;
            flex-shrink: 0;
        }

        .emotion {
            font-size: 1.5rem;
            opacity: 0.3;
            transition: all 0.4s ease;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
        }

        .emotion.active {
            opacity: 1;
            transform: scale(1.2);
            background: rgba(255,255,255,0.2);
            box-shadow: 0 0 15px rgba(255,255,255,0.5);
        }

        /* è¿›åº¦æ¡ */
        .progress-container {
            margin: 10px 0;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 3px;
            backdrop-filter: blur(10px);
            flex-shrink: 0;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #F39C12, #E67E22, #27AE60);
            width: 0%;
            transition: width 0.8s ease;
            border-radius: 15px;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            text-align: center;
            margin-top: 5px;
            font-size: 0.8rem;
            opacity: 0.8;
        }

        /* å¯¹è¯æ°”æ³¡ç³»ç»Ÿ */
        .dialogue-container {
            flex: 1;
            margin: 10px 0;
            min-height: 0;
            display: flex;
            flex-direction: column;
        }

        .dialogue-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            flex: 1;
            min-height: 0;
        }

        .user-thoughts, .system-response {
            background: rgba(0,0,0,0.8);
            padding: 15px;
            border-radius: 12px;
            backdrop-filter: blur(15px);
            border: 2px solid;
            position: relative;
            opacity: 0;
            transform: translateY(15px);
            transition: all 0.5s ease;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .user-thoughts {
            border-color: #FF6B6B;
            background: linear-gradient(135deg, rgba(255,107,107,0.1), rgba(0,0,0,0.8));
        }

        .system-response {
            border-color: #4ECDC4;
            background: linear-gradient(135deg, rgba(78,205,196,0.1), rgba(0,0,0,0.8));
        }

        .dialogue-panel.active .user-thoughts,
        .dialogue-panel.active .system-response {
            opacity: 1;
            transform: translateY(0);
        }

        .dialogue-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-weight: bold;
            flex-shrink: 0;
        }

        .dialogue-avatar {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            margin-right: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .user-avatar {
            background: #FF6B6B;
        }

        .system-avatar {
            background: #4ECDC4;
        }

        .dialogue-content {
            line-height: 1.4;
            font-size: 0.9rem;
            flex: 1;
            overflow-y: auto;
            margin: 8px 0;
        }

        .dialogue-details {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid rgba(255,255,255,0.2);
            font-size: 0.75rem;
            opacity: 0.8;
            flex-shrink: 0;
        }

        .detail-item {
            margin-bottom: 3px;
        }

        /* æ§åˆ¶é¢æ¿ */
        .control-panel {
            text-align: center;
            margin: 10px 0 15px 0;
            display: flex;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
            position: relative;
            z-index: 1001;
            background: rgba(30, 60, 114, 0.8);
            padding: 12px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            flex-shrink: 0;
        }

        .btn {
            background: linear-gradient(45deg, #3498DB, #2980B9);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 3px 12px rgba(52, 152, 219, 0.3);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.5);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn.primary {
            background: linear-gradient(45deg, #E74C3C, #C0392B);
            box-shadow: 0 3px 12px rgba(231, 76, 60, 0.3);
        }

        .btn.success {
            background: linear-gradient(45deg, #27AE60, #229954);
            box-shadow: 0 3px 12px rgba(39, 174, 96, 0.3);
        }

        /* èŠ‚ç‚¹è¯¦æƒ…å¼¹çª— */
        .node-detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .node-detail-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(30,60,114,0.95), rgba(42,82,152,0.95));
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255,255,255,0.2);
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .node-detail-modal.active .modal-content {
            transform: scale(1);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.5rem;
            margin-bottom: 8px;
            color: #a8e6cf;
        }

        .modal-close {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            color: #fff;
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .modal-close:hover {
            opacity: 1;
        }

        /* æµ®åŠ¨ç²’å­ */
        .floating-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            animation: float 8s infinite linear;
        }

        .particle.small {
            width: 2px;
            height: 2px;
            background: rgba(255,255,255,0.4);
        }

        .particle.medium {
            width: 3px;
            height: 3px;
            background: rgba(168,230,207,0.3);
        }

        .particle.large {
            width: 4px;
            height: 4px;
            background: rgba(243,156,18,0.2);
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) translateX(100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: 5px 10px;
            }
            
            .stats-panel {
                position: relative;
                top: auto;
                right: auto;
                margin-bottom: 10px;
                min-width: auto;
                font-size: 0.75rem;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .journey-map {
                height: 200px;
            }
            
            .journey-node {
                width: 45px;
                height: 45px;
            }
            
            .node-icon {
                font-size: 1.2rem;
            }
            
            .dialogue-panel {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .control-panel {
                gap: 5px;
                padding: 8px;
            }
            
            .btn {
                font-size: 0.75rem;
                padding: 6px 12px;
            }
            
            .dialogue-content {
                font-size: 0.8rem;
            }
            
            .detail-item {
                font-size: 0.7rem;
            }
        }

        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
    </style>
</head>
<body>
    <div class="floating-particles" id="particles"></div>
    
    <div class="container">
        <div class="header">
            <h1>æ•°å­—é—äº§ç»§æ‰¿ä¹‹æ—…</h1>
            <p>å½“è‡³äº²ç¦»å»ï¼Œæˆ‘å°è¯•åœ¨è…¾è®¯ç”Ÿæ€ä¸­ï¼Œå®ˆæŠ¤ä»–ç•™ä¸‹çš„æ•°å­—å°è®°ã€‚</p>
            <div class="emotional-indicator">
                <span class="emotion" data-emotion="confused" title="å›°æƒ‘">ğŸ˜•</span>
                <span class="emotion" data-emotion="hopeful" title="å¸Œæœ›">ğŸ¤”</span>
                <span class="emotion" data-emotion="frustrated" title="æ²®ä¸§">ğŸ˜¤</span>
                <span class="emotion" data-emotion="sad" title="æ‚²ä¼¤">ğŸ˜¢</span>
                <span class="emotion" data-emotion="determined" title="åšå®š">ğŸ’ª</span>
                <span class="emotion" data-emotion="relieved" title="é‡Šç„¶">ğŸ˜Œ</span>
            </div>
        </div>

        <div class="stats-panel">
            <h3>ğŸ“Š æ—…ç¨‹æ•°æ®</h3>
            <div class="stat-item">
                <span>å½“å‰è¿›åº¦:</span>
                <span id="current-progress">0%</span>
            </div>
            <div class="stat-item">
                <span>æˆåŠŸç‡:</span>
                <span id="success-rate">æœªçŸ¥</span>
            </div>
            <div class="stat-item">
                <span>å¹³å‡è€—æ—¶:</span>
                <span id="avg-time">0å¤©</span>
            </div>
            <div class="stat-item">
                <span>ç”¨æˆ·æ»¡æ„åº¦:</span>
                <span id="satisfaction">0/5</span>
            </div>
            <div class="stat-item">
                <span>å·²è®¿é—®èŠ‚ç‚¹:</span>
                <span id="visited-nodes">0/8</span>
            </div>
            <div class="stat-item">
                <span>å‘ç°ç—›ç‚¹:</span>
                <span id="pain-points">0ä¸ª</span>
            </div>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="progress-text" id="progress-text">å‡†å¤‡å¼€å§‹æ—…ç¨‹...</div>
        </div>

        <div class="journey-map">
            <div class="journey-path"></div>
            
            <!-- å°äººè§’è‰² -->
            <div class="character" id="character">
                <div class="character-avatar">ğŸ‘¤</div>
            </div>
            
            <!-- èŠ‚ç‚¹1: èµ·ç‚¹ -->
            <div class="journey-node active" style="left: 8%; top: 45%;" data-node="0">
                <div class="node-icon">ğŸ </div>
            </div>

            <!-- èŠ‚ç‚¹2: ç»Ÿä¸€å…¥å£çš„è¿·æ€ -->
            <div class="journey-node blocked" style="left: 20%; top: 25%;" data-node="1">
                <div class="node-icon">ğŸ”</div>
            </div>

            <!-- èŠ‚ç‚¹3: è´¦å·å½’å±çš„"éšç§å¢™" -->
            <div class="journey-node blocked" style="left: 32%; top: 15%;" data-node="2">
                <div class="node-icon">ğŸ’¬</div>
            </div>

            <!-- èŠ‚ç‚¹4: å¾®ä¿¡/QQé’±åŒ…ï¼šèµ„äº§çš„ç»§æ‰¿ -->
            <div class="journey-node warning" style="left: 44%; top: 65%;" data-node="3">
                <div class="node-icon">ğŸ’°</div>
            </div>

            <!-- èŠ‚ç‚¹5: èŠå¤©è®°å½•ä¸æœ‹å‹åœˆï¼šæƒ…æ„Ÿçš„æ–­ç‚¹ -->
            <div class="journey-node blocked" style="left: 56%; top: 30%;" data-node="4">
                <div class="node-icon">ğŸ˜¢</div>
            </div>

            <!-- èŠ‚ç‚¹6: è…¾è®¯æ–‡æ¡£ï¼šæ•°æ®ä¸è¯æ˜ -->
            <div class="journey-node warning" style="left: 68%; top: 20%;" data-node="5">
                <div class="node-icon">ğŸ“„</div>
            </div>

            <!-- èŠ‚ç‚¹7: æ¸¸æˆèµ„äº§ï¼šè™šæ‹Ÿä¸–ç•Œçš„æ¶ˆé€ -->
            <div class="journey-node blocked" style="left: 80%; top: 50%;" data-node="6">
                <div class="node-icon">ğŸ®</div>
            </div>

            <!-- èŠ‚ç‚¹8: ç»ˆç‚¹ï¼šåæ€ä¸å‘¼å -->
            <div class="journey-node success" style="left: 92%; top: 45%;" data-node="7">
                <div class="node-icon">ğŸ¯</div>
            </div>
        </div>

        <!-- å¯¹è¯ç³»ç»Ÿ -->
        <div class="dialogue-container">
            <div class="dialogue-panel" id="dialogue-panel">
                <div class="user-thoughts">
                    <div class="dialogue-header">
                        <div class="dialogue-avatar user-avatar">ğŸ‘¤</div>
                        <span>æˆ‘çš„æƒ³æ³•</span>
                    </div>
                    <div class="dialogue-content" id="user-thoughts-content">
                        ç‚¹å‡»èŠ‚ç‚¹å¼€å§‹æ‚¨çš„æ•°å­—é—äº§ç»§æ‰¿ä¹‹æ—…...
                    </div>
                    <div class="dialogue-details" id="user-details">
                        <div class="detail-item">ğŸ’­ å†…å¿ƒçŠ¶æ€: å‡†å¤‡ä¸­</div>
                        <div class="detail-item">ğŸ¯ å½“å‰ç›®æ ‡: äº†è§£æµç¨‹</div>
                    </div>
                </div>
                
                <div class="system-response">
                    <div class="dialogue-header">
                        <div class="dialogue-avatar system-avatar">ğŸ¤–</div>
                        <span>ç³»ç»Ÿåé¦ˆ</span>
                    </div>
                    <div class="dialogue-content" id="system-response-content">
                        ç³»ç»Ÿå‡†å¤‡å°±ç»ªï¼Œç­‰å¾…ç”¨æˆ·æ“ä½œ...
                    </div>
                    <div class="dialogue-details" id="system-details">
                        <div class="detail-item">âš™ï¸ ç³»ç»ŸçŠ¶æ€: å¾…æœºä¸­</div>
                        <div class="detail-item">ğŸ“‹ å¯ç”¨é€‰é¡¹: æµè§ˆèŠ‚ç‚¹</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="control-panel">
            <button class="btn" id="prev-btn" disabled>â† ä¸Šä¸€æ­¥</button>
            <button class="btn primary" id="next-btn">ä¸‹ä¸€æ­¥ â†’</button>
            <button class="btn" id="reset-btn">ğŸ”„ é‡æ–°å¼€å§‹</button>
            <button class="btn success" id="auto-play-btn">â–¶ï¸ è‡ªåŠ¨æ’­æ”¾</button>
            <button class="btn" id="detail-btn">ğŸ“‹ æŸ¥çœ‹è¯¦æƒ…</button>
        </div>
    </div>

    <!-- è¯¦æƒ…å¼¹çª— -->
    <div class="node-detail-modal" id="detail-modal">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">Ã—</button>
            <div class="modal-header">
                <div class="modal-title" id="modal-title">èŠ‚ç‚¹è¯¦æƒ…</div>
            </div>
            <div id="modal-body">
                <!-- è¯¦ç»†å†…å®¹å°†åœ¨è¿™é‡ŒåŠ¨æ€åŠ è½½ -->
            </div>
        </div>
    </div>

    <script>
        // é‡æ„åçš„æ—…ç¨‹æ•°æ®
        const journeyData = [
            {
                title: "èµ·ç‚¹ï¼šéª¤ç„¶ç¦»å»ä¸æ•°å­—å¯»è§…",
                userThoughts: "å®¶äººçªç„¶ç¦»ä¸–ï¼Œä»–çš„å¾®ä¿¡é‡Œè¿˜æœ‰ä½™é¢ï¼ŒQQç©ºé—´é‡Œæœ‰çè´µçš„ç…§ç‰‡ã€‚æˆ‘è¯¥å¦‚ä½•å¼€å§‹ï¼Œå®ˆæŠ¤ä»–æœ€åçš„æ•°å­—å°è®°ï¼Ÿ",
                systemResponse: "æ¬¢è¿ä½¿ç”¨è…¾è®¯æ•°å­—é—äº§æœåŠ¡ã€‚è¯·æ³¨æ„ï¼šä¸åŒäº§å“æœ‰ä¸åŒçš„ç»§æ‰¿æ”¿ç­–ï¼Œä¸”è´¦å·æœ¬èº«ä¸å…·å¤‡ç»§æ‰¿å±æ€§ã€‚",
                emotion: "confused",
                userDetails: {
                    mood: "æ‚²ä¼¤ã€å›°æƒ‘",
                    goal: "äº†è§£æ•°å­—é—äº§ç»§æ‰¿æµç¨‹",
                    concerns: "ä¸çŸ¥é“ä»ä½•å¼€å§‹ï¼Œæ‹…å¿ƒé—å¤±é‡è¦ä¿¡æ¯"
                },
                systemDetails: {
                    status: "æœåŠ¡å¯ç”¨",
                    options: "æŸ¥çœ‹å„äº§å“ç»§æ‰¿æ”¿ç­–",
                    requirements: "éœ€è¦æä¾›ç›¸å…³è¯æ˜ææ–™"
                },
                stats: { progress: 0, successRate: "æœªçŸ¥", avgTime: "0å¤©", satisfaction: "0/5", painPoints: 0 },
                detailedInfo: {
                    background: "å®¶äººçªç„¶ç¦»ä¸–ï¼Œç”¨æˆ·é¢ä¸´æ•°å­—èµ„äº§ç»§æ‰¿å’Œæƒ…æ„Ÿæ•°æ®ç•™å­˜çš„åŒé‡è¯‰æ±‚ã€‚",
                    challenges: ["ç¼ºä¹ç»Ÿä¸€çš„èµ·å§‹ç‚¹", "æƒ…æ„Ÿå‹åŠ›å·¨å¤§", "ä¸æ¸…æ¥šæ•°å­—é—äº§çš„è¾¹ç•Œ"],
                    opportunities: ["äº†è§£å„å¹³å°æ”¿ç­–", "å‡†å¤‡å¿…è¦ææ–™", "å¯»æ±‚ä¸“ä¸šå¸®åŠ©"]
                }
            },
            {
                title: "ç»Ÿä¸€å…¥å£çš„è¿·æ€",
                userThoughts: "æ˜¯å¦æœ‰ç»Ÿä¸€çš„\"çºªå¿µè´¦å·\"æˆ–\"é—äº§è”ç³»äºº\"äº§å“ï¼Ÿæˆ‘å¯ä»¥åœ¨å“ªé‡Œç”³è¯·ç»§æ‰¿ï¼Ÿ",
                systemResponse: "æŠ±æ­‰ï¼Œç›®å‰æ²¡æœ‰ç”Ÿå‰è®¾ç½®çš„çºªå¿µè´¦å·äº§å“ã€‚ç»§æ‰¿æœåŠ¡åˆ†æ•£åœ¨å„äº§å“çº¿ï¼Œè¯·åˆ†åˆ«è”ç³»å„äº§å“å®¢æœã€‚",
                emotion: "frustrated",
                userDetails: {
                    mood: "è¿·èŒ«ã€ç„¦è™‘",
                    goal: "æ‰¾åˆ°æ­£ç¡®çš„ç”³è¯·å…¥å£",
                    concerns: "æµªè´¹æ—¶é—´ï¼Œä¸çŸ¥é“æ‰¾è°"
                },
                systemDetails: {
                    status: "æœåŠ¡åˆ†æ•£",
                    options: "åˆ†åˆ«è”ç³»å„äº§å“å®¢æœ",
                    requirements: "éœ€è¦å¤šæ¬¡å’¨è¯¢"
                },
                stats: { progress: 10, successRate: "15%", avgTime: "3å¤©", satisfaction: "1.0/5", painPoints: 2 },
                detailedInfo: {
                    background: "è…¾è®¯ç”Ÿæ€å†…ç¼ºä¹ç»Ÿä¸€çš„æ•°å­—é—äº§æœåŠ¡å…¥å£ï¼Œå„ä¸šåŠ¡ä¾èµ–äººå·¥å®¢æœä¸ªæ¡ˆå¤„ç†ã€‚",
                    challenges: ["å…¥å£åˆ†æ•£", "ä¿¡æ¯ä¸å¯¹ç§°", "æ— é¢„è®¾æœºåˆ¶"],
                    impact: "ç”¨æˆ·åœ¨æ‚²ç—›ä¸­æµªè´¹å¤§é‡æ—¶é—´å¯»æ‰¾å…¥å£ï¼ŒåŠ å‰§ç„¦è™‘ã€‚è®¿è°ˆæ˜¾ç¤ºï¼Œå›¢é˜Ÿæ‹…å¿§\"æ­»äº¡é¢„è®¾\"åŠŸèƒ½çš„ç”¨æˆ·å¿ƒç†æ¥å—åº¦ã€‚"
                }
            },
            {
                title: "è´¦å·å½’å±çš„\"éšç§å¢™\"",
                userThoughts: "æˆ‘å¯ä»¥ç›´æ¥ç»§æ‰¿å®¶äººçš„å¾®ä¿¡/QQè´¦å·å—ï¼Ÿè¿™æ ·æˆ‘å°±å¯ä»¥ç›´æ¥ç™»å½•æŸ¥çœ‹ä»–çš„ä¸€åˆ‡äº†ã€‚",
                systemResponse: "æ ¹æ®ç”¨æˆ·åè®®ï¼Œè´¦å·ä¸»ä½“å½’å¹³å°æ‰€æœ‰ï¼Œä¸æ”¯æŒç»§æ‰¿ã€‚å‡ºäºéšç§ä¿æŠ¤ï¼Œå¹³å°ä¸æä¾›è´¦å·è½¬ç§»æˆ–ç™»å½•æƒé™ã€‚",
                emotion: "sad",
                userDetails: {
                    mood: "å¤±æœ›ã€æ— åŠ©",
                    goal: "å°è¯•è·å–è´¦å·ç™»å½•æƒé™",
                    concerns: "è´¦å·é‡Œçš„é‡è¦ä¿¡æ¯æ— æ³•è·å–"
                },
                systemDetails: {
                    status: "è´¦å·ä¸å¯ç»§æ‰¿",
                    options: "å°è¯•ç”³è¯·èµ„äº§ç»§æ‰¿",
                    requirements: "æ³•åŠ¡ä¸éšç§é¡¾è™‘æ™®é"
                },
                stats: { progress: 25, successRate: "10%", avgTime: "7å¤©", satisfaction: "0.5/5", painPoints: 4 },
                detailedInfo: {
                    background: "å¾®ä¿¡/QQè´¦å·è¢«è§†ä¸ºä¸ªäººèº«ä»½æ ‡è¯†ï¼Œå½’å¹³å°æ‰€æœ‰ï¼Œä¸å…·å¤‡ç»§æ‰¿å±æ€§ã€‚",
                    challenges: ["æ³•å¾‹åˆè§„", "éšç§é¡¾è™‘", "è´¦å·ä¸å¯è½¬ç§»"],
                    impact: "å¤±å»çš„ä¸ä»…æ˜¯è´¦å·ï¼Œæ›´æ˜¯ç”¨æˆ·åœ¨æ•°å­—ä¸–ç•Œä¸­çš„èº«ä»½å’Œç¤¾äº¤å…³ç³»é“¾ã€‚"
                }
            },
            {
                title: "å¾®ä¿¡/QQé’±åŒ…ï¼šèµ„äº§çš„ç»§æ‰¿",
                userThoughts: "å¤ªå¥½äº†ï¼å¾®ä¿¡/QQé’±åŒ…é‡Œçš„ä½™é¢å¯ä»¥ç”³è¯·ç»§æ‰¿ã€‚ä½†æ˜¯è¦è¿™ä¹ˆå¤šææ–™...æ­»äº¡è¯æ˜ã€å…¬è¯ä¹¦ï¼Œè¿˜è¦ç­‰è¿™ä¹ˆä¹…ï¼Ÿ",
                systemResponse: "æ‚¨çš„è´¢äº§ç»§æ‰¿ç”³è¯·å·²è¿›å…¥å®¡æ ¸æµç¨‹ã€‚éœ€æä¾›æ³•å®šè¯æ˜ææ–™ï¼Œé¢„è®¡éœ€è¦7-15ä¸ªå·¥ä½œæ—¥ã€‚",
                emotion: "determined",
                userDetails: {
                    mood: "åšå®šã€ç–²æƒ«",
                    goal: "å®Œæˆèµ„äº§ç»§æ‰¿ç”³è¯·",
                    concerns: "æµç¨‹ç¹çï¼Œæ—¶é—´æ¼«é•¿"
                },
                systemDetails: {
                    status: "æµç¨‹ä¸¥è°¨",
                    options: "ç­‰å¾…å®¡æ ¸ç»“æœ",
                    requirements: "æä¾›å®Œæ•´çš„æ³•å¾‹æ–‡ä»¶"
                },
                stats: { progress: 40, successRate: "50%", avgTime: "15å¤©", satisfaction: "2.5/5", painPoints: 5 },
                detailedInfo: {
                    background: "å¾®ä¿¡æ”¯ä»˜ã€QQé’±åŒ…ç­‰è´§å¸æ€§èµ„äº§å…·å¤‡å¯ä¾æ³•ç»§æ‰¿æœºåˆ¶ã€‚",
                    challenges: ["ææ–™å¤æ‚", "æµç¨‹ä¸é€æ˜", "è·¨äº§å“è¯†åˆ«éš¾"],
                    materials: ["æ­»äº¡è¯æ˜", "äº²å±å…³ç³»è¯æ˜", "ç»§æ‰¿äººèº«ä»½è¯æ˜", "å…¬è¯ä¹¦/æ³•é™¢è£å®š"],
                    impact: "æµç¨‹çš„ä¸¥è°¨æ€§ä¸ç”¨æˆ·åœ¨æ‚²ç—›æœŸçš„å¿ƒç†è´Ÿæ‹…å½¢æˆå¼ºçƒˆå†²çªã€‚"
                }
            },
            {
                title: "èŠå¤©è®°å½•ä¸æœ‹å‹åœˆï¼šæƒ…æ„Ÿçš„æ–­ç‚¹",
                userThoughts: "èµ„äº§å¯ä»¥ç»§æ‰¿ï¼Œä½†é‚£äº›èŠå¤©è®°å½•ã€æœ‹å‹åœˆèƒ½å¦å¯¼å‡ºï¼Ÿæˆ‘æƒ³å†å¬å¬å®¶äººçš„å£°éŸ³ï¼Œçœ‹çœ‹ä»–çš„ç…§ç‰‡...",
                systemResponse: "æŠ±æ­‰ï¼ŒèŠå¤©è®°å½•ã€æœ‹å‹åœˆå†…å®¹ã€å¥½å‹å…³ç³»é“¾ä¸€å¾‹ä¸å¼€æ”¾å¯¼å‡ºã€‚è¿™äº›ä¿¡æ¯è¢«è§†ä¸ºä¸ªäººéšç§ï¼Œå¹³å°æ— æƒè®¿é—®æˆ–è½¬ç§»ã€‚",
                emotion: "sad",
                userDetails: {
                    mood: "ç»æœ›ã€æ‚²ä¼¤",
                    goal: "å°è¯•è·å–æƒ…æ„Ÿæ•°æ®",
                    concerns: "å¤±å»ä¸é€è€…æœ€åçš„\"è¿æ¥\""
                },
                systemDetails: {
                    status: "éšç§é™åˆ¶",
                    options: "å°è¯•é€šè¿‡æœ¬åœ°è®¾å¤‡å¤‡ä»½",
                    requirements: "æœåŠ¡å™¨ä¸ä¿å­˜é•¿æœŸèŠå¤©è®°å½•"
                },
                stats: { progress: 55, successRate: "5%", avgTime: "20å¤©", satisfaction: "0.5/5", painPoints: 7 },
                detailedInfo: {
                    background: "èŠå¤©è®°å½•ã€æœ‹å‹åœˆã€QQç©ºé—´å†…å®¹ç­‰è¢«è§†ä¸ºå¼ºéšç§ä¿¡æ¯ï¼Œä¸€å¾‹ä¸å¼€æ”¾å¯¼å‡ºã€‚",
                    challenges: ["æŠ€æœ¯é™åˆ¶ï¼ˆæœ¬åœ°å­˜å‚¨ï¼‰", "éšç§è¾¹ç•Œï¼ˆæ¶‰åŠç¬¬ä¸‰æ–¹ï¼‰", "æƒ…æ„Ÿè¯‰æ±‚æ— æ³•æ»¡è¶³"],
                    impact: "æœ€å¤§çš„èˆ†æƒ…é£é™©æ¥è‡ª\"å®¶å±æ— æ³•è·å–çºªå¿µå†…å®¹\"è€Œäº§ç”Ÿçš„æƒ…æ„Ÿåå¼¹ã€‚å¤±å»çš„ä¸ä»…æ˜¯æ•°æ®ï¼Œæ›´æ˜¯ä¸é€è€…æœ€åçš„\"è¿æ¥\"ã€‚"
                }
            },
            {
                title: "è…¾è®¯æ–‡æ¡£ï¼šæ•°æ®ä¸è¯æ˜",
                userThoughts: "å¹¸å¥½å®¶äººç”Ÿå‰åœ¨è…¾è®¯æ–‡æ¡£é‡Œç•™ä¸‹äº†é—å˜±è‰ç¨¿å’Œä¸€äº›é‡è¦æ–‡ä»¶ã€‚è¿™äº›æ•°æ®èƒ½é¡ºåˆ©æ‹¿åˆ°å—ï¼Ÿ",
                systemResponse: "è…¾è®¯æ–‡æ¡£æ•°æ®å±äºæ•°å­—å†…å®¹èµ„äº§ï¼Œéœ€æä¾›å…¬è¯ä¹¦ç­‰ææ–™ï¼Œç»å®¡æ ¸åå¯æå–ã€‚æµç¨‹ç›¸å¯¹æ¸…æ™°ï¼Œä½†ä»éœ€æ³•å¾‹æ–‡ä»¶è¯æ˜ã€‚",
                emotion: "hopeful",
                userDetails: {
                    mood: "è°¨æ…ã€æœŸå¾…",
                    goal: "è·å–é‡è¦æ–‡ä»¶æ•°æ®",
                    concerns: "æ‹…å¿ƒæ•°æ®æ‰€æœ‰æƒè¯æ˜å¤æ‚"
                },
                systemDetails: {
                    status: "å†…å®¹èµ„äº§å¯æå–",
                    options: "å‡†å¤‡å…¬è¯ä¹¦",
                    requirements: "éœ€åŒºåˆ†ä¸ªäººæ•°æ®å’Œè´¢äº§æ•°æ®"
                },
                stats: { progress: 70, successRate: "65%", avgTime: "25å¤©", satisfaction: "3.0/5", painPoints: 4 },
                detailedInfo: {
                    background: "è…¾è®¯æ–‡æ¡£ã€é‚®ç®±ç­‰æ•°æ®å†…å®¹èµ„äº§çš„ç»§æ‰¿ã€‚",
                    challenges: ["æ•°æ®åˆ†çº§å¤æ‚", "æ³•å¾‹è¯æ˜è¦æ±‚é«˜", "æŠ€æœ¯å®ç°éš¾åº¦"],
                    opportunities: ["å¹³å°åº”æä¾›\"æ•°å­—é—å˜±\"åŠŸèƒ½", "ç®€åŒ–éæ•æ„Ÿæ•°æ®çš„æå–æµç¨‹"]
                }
            },
            {
                title: "æ¸¸æˆèµ„äº§ï¼šè™šæ‹Ÿä¸–ç•Œçš„æ¶ˆé€",
                userThoughts: "é‚£æ¸¸æˆå‘¢ï¼Ÿä»–çš„è´¦å·æˆ‘èƒ½å†ä½¿ç”¨å—ï¼Ÿé‡Œé¢çš„çš®è‚¤ã€ç‚¹åˆ¸ã€æ®µä½è¿™äº›è£èª‰èµ„äº§å‘¢ï¼Ÿ",
                systemResponse: "æ¸¸æˆè´¦å·æœ¬èº«ä¸å¯ç»§æ‰¿ã€‚ç‚¹åˆ¸ã€çš®è‚¤ç­‰è™šæ‹Ÿèµ„äº§ä¾èµ–è´¦å·ï¼Œæ— æ³•ç‹¬ç«‹è½¬ç§»æˆ–è¿”è¿˜ã€‚è£èª‰èµ„äº§ä¹Ÿä¸æ”¯æŒè½¬ç§»ã€‚",
                emotion: "sad",
                userDetails: {
                    mood: "æ— å¥ˆã€å¤±è½",
                    goal: "å°è¯•ä¿ç•™æ¸¸æˆè´¦å·æˆ–èµ„äº§",
                    concerns: "è™šæ‹Ÿèµ„äº§æ— æ³•ç»§æ‰¿"
                },
                systemDetails: {
                    status: "è´¦å·ä¸å¯ç»§æ‰¿",
                    options: "å»ºè®®æˆªå›¾æˆ–å½•å±ä¿å­˜",
                    requirements: "è™šæ‹Ÿèµ„äº§ä¾èµ–è´¦å·ï¼Œç‹¬ç«‹ä¸å‡ºæ¥"
                },
                stats: { progress: 85, successRate: "20%", avgTime: "28å¤©", satisfaction: "1.5/5", painPoints: 6 },
                detailedInfo: {
                    background: "æ¸¸æˆè´¦å·ï¼ˆå¦‚ç‹è€…è£è€€ï¼‰çš„è™šæ‹Ÿèµ„äº§ç»§æ‰¿ã€‚",
                    challenges: ["èµ„äº§åˆ†ç¦»éš¾", "è£èª‰ä¸å¯è½¬", "çºªå¿µæ¨¡å¼ç¼ºå¤±"],
                    impact: "æ¸¸æˆé‡Œçš„æ•°å­—èº«ä»½å·²è¶…è¶Šå¨±ä¹ï¼Œå…¶æ¶ˆé€å¯¹å®¶å±ä¹Ÿæ˜¯ä¸€ç§æƒ…æ„ŸæŸå¤±ã€‚"
                }
            },
            {
                title: "ç»ˆç‚¹ï¼šåæ€ä¸å‘¼å",
                userThoughts: "æ•´ä¸ªè¿‡ç¨‹è€—æ—¶æ¼«é•¿ï¼Œå¿ƒåŠ›äº¤ç˜ã€‚å¸Œæœ›æœªæ¥èƒ½æœ‰ä¸€ä¸ªæ›´äººæ€§åŒ–ã€æ›´ç»Ÿä¸€çš„æµç¨‹ã€‚",
                systemResponse: "æ„Ÿè°¢æ‚¨çš„åé¦ˆã€‚æ‚¨çš„ç»å†å°†å¸®åŠ©æˆ‘ä»¬æ”¹è¿›æœåŠ¡ã€‚æ•°å­—é—äº§çš„æœªæ¥éœ€è¦æ›´å¤šå…³æ³¨å’Œç«‹æ³•æ¨åŠ¨ã€‚",
                emotion: "relieved",
                userDetails: {
                    mood: "é‡Šç„¶ã€åæ€",
                    goal: "æ€»ç»“æ—…ç¨‹ï¼Œæå‡ºæ”¹è¿›å»ºè®®",
                    concerns: "æµç¨‹ç¼ºä¹äººæ€§åŒ–"
                },
                systemDetails: {
                    status: "æ—…ç¨‹ç»“æŸ",
                    options: "æ¨åŠ¨è¡Œä¸šæ ‡å‡†ä¸ç«‹æ³•",
                    requirements: "æ¢ç´¢\"çºªå¿µåŒ–\"å±•ç¤ºè·¯å¾„"
                },
                stats: { progress: 100, successRate: "35%", avgTime: "30å¤©", satisfaction: "2.0/5", painPoints: 0 },
                detailedInfo: {
                    background: "æ—…ç¨‹ç»“æŸï¼Œç”¨æˆ·å¯¹æ•´ä¸ªæµç¨‹è¿›è¡Œæ€»ç»“å’Œåæ€ã€‚",
                    challenges: ["æµç¨‹ç¼ºä¹äººæ€§åŒ–", "ç¼ºä¹ç»Ÿä¸€æ ‡å‡†", "æ³•å¾‹æ¡†æ¶ç¼ºå¤±"],
                    opportunities: ["å‘¼åè¡Œä¸šå»ºç«‹ç»Ÿä¸€æ ‡å‡†", "æ¨åŠ¨æ•°å­—é—äº§ç«‹æ³•", "æ¢ç´¢\"çºªå¿µåŒ–\"å±•ç¤ºçš„æŠ€æœ¯ä¸äº§å“è·¯å¾„"]
                }
            }
        ];

        let currentStep = 0;
        let autoPlayInterval = null;
        let visitedNodes = new Set([0]);

        // DOM å…ƒç´ 
        const nodes = document.querySelectorAll('.journey-node');
        const character = document.getElementById('character');
        const dialoguePanel = document.getElementById('dialogue-panel');
        const userThoughtsContent = document.getElementById('user-thoughts-content');
        const systemResponseContent = document.getElementById('system-response-content');
        const userDetails = document.getElementById('user-details');
        const systemDetails = document.getElementById('system-details');
        const progressFill = document.getElementById('progress-fill');
        const progressText = document.getElementById('progress-text');
        const emotions = document.querySelectorAll('.emotion');

        // æ§åˆ¶æŒ‰é’®
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const resetBtn = document.getElementById('reset-btn');
        const autoPlayBtn = document.getElementById('auto-play-btn');
        const detailBtn = document.getElementById('detail-btn');

        // ç»Ÿè®¡é¢æ¿å…ƒç´ 
        const currentProgressEl = document.getElementById('current-progress');
        const successRateEl = document.getElementById('success-rate');
        const avgTimeEl = document.getElementById('avg-time');
        const satisfactionEl = document.getElementById('satisfaction');
        const visitedNodesEl = document.getElementById('visited-nodes');
        const painPointsEl = document.getElementById('pain-points');

        // è¯¦æƒ…å¼¹çª—
        const detailModal = document.getElementById('detail-modal');
        const modalClose = document.getElementById('modal-close');
        const modalTitle = document.getElementById('modal-title');
        const modalBody = document.getElementById('modal-body');

        // åˆå§‹åŒ–
        function init() {
            updateDisplay();
            createEnhancedParticles();
            
            // æ·»åŠ èŠ‚ç‚¹ç‚¹å‡»äº‹ä»¶
            nodes.forEach((node, index) => {
                node.addEventListener('click', () => goToStep(index));
            });

            // æŒ‰é’®äº‹ä»¶
            prevBtn.addEventListener('click', prevStep);
            nextBtn.addEventListener('click', nextStep);
            resetBtn.addEventListener('click', reset);
            autoPlayBtn.addEventListener('click', toggleAutoPlay);
            detailBtn.addEventListener('click', showDetailModal);
            modalClose.addEventListener('click', hideDetailModal);

            // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
            detailModal.addEventListener('click', (e) => {
                if (e.target === detailModal) {
                    hideDetailModal();
                }
            });
        }

        // æ›´æ–°æ˜¾ç¤º
        function updateDisplay() {
            const data = journeyData[currentStep];
            
            // æ›´æ–°å¯¹è¯å†…å®¹
            userThoughtsContent.textContent = data.userThoughts;
            systemResponseContent.textContent = data.systemResponse;
            
            // æ›´æ–°è¯¦ç»†ä¿¡æ¯
            userDetails.innerHTML = `
                <div class="detail-item">ğŸ’­ å¿ƒæƒ…: ${data.userDetails.mood}</div>
                <div class="detail-item">ğŸ¯ ç›®æ ‡: ${data.userDetails.goal}</div>
                <div class="detail-item">ğŸ˜Ÿ æ‹…å¿§: ${data.userDetails.concerns}</div>
            `;
            
            systemDetails.innerHTML = `
                <div class="detail-item">âš™ï¸ çŠ¶æ€: ${data.systemDetails.status}</div>
                <div class="detail-item">ğŸ“‹ é€‰é¡¹: ${data.systemDetails.options}</div>
                <div class="detail-item">ğŸ“ è¦æ±‚: ${data.systemDetails.requirements}</div>
            `;

            // ç‰¹æ®Šå¤„ç†èµ·ç‚¹èŠ‚ç‚¹ï¼šåªæ˜¾ç¤ºç”¨æˆ·æƒ³æ³•ï¼Œå±…ä¸­æ˜¾ç¤º
            if (currentStep === 0) {
                dialoguePanel.style.gridTemplateColumns = '1fr';
                dialoguePanel.style.justifyItems = 'center';
                document.querySelector('.system-response').style.display = 'none';
                document.querySelector('.user-thoughts').style.maxWidth = '600px';
            } else {
                dialoguePanel.style.gridTemplateColumns = '1fr 1fr';
                dialoguePanel.style.justifyItems = 'stretch';
                document.querySelector('.system-response').style.display = 'flex';
                document.querySelector('.user-thoughts').style.maxWidth = 'none';
            }

            // æ¿€æ´»å¯¹è¯é¢æ¿åŠ¨ç”»
            dialoguePanel.classList.remove('active');
            setTimeout(() => {
                dialoguePanel.classList.add('active');
            }, 100);

            // æ›´æ–°è¿›åº¦æ¡å’Œæ–‡æœ¬
            progressFill.style.width = `${data.stats.progress}%`;
            progressText.textContent = `${data.title} (${data.stats.progress}%)`;

            // æ›´æ–°ç»Ÿè®¡é¢æ¿
            currentProgressEl.textContent = `${data.stats.progress}%`;
            successRateEl.textContent = data.stats.successRate;
            avgTimeEl.textContent = data.stats.avgTime;
            satisfactionEl.textContent = data.stats.satisfaction;
            visitedNodesEl.textContent = `${visitedNodes.size}/8`;
            painPointsEl.textContent = `${data.stats.painPoints}ä¸ª`;

            // æ›´æ–°èŠ‚ç‚¹çŠ¶æ€
            nodes.forEach((node, index) => {
                node.classList.remove('active');
                if (visitedNodes.has(index)) {
                    node.classList.add('visited');
                }
                if (index === currentStep) {
                    node.classList.add('active');
                    node.classList.remove('visited');
                }
            });

            // ç§»åŠ¨å°äººè§’è‰²
            moveCharacter();

            // æ›´æ–°æƒ…æ„ŸæŒ‡ç¤ºå™¨
            emotions.forEach(emotion => emotion.classList.remove('active'));
            const currentEmotion = document.querySelector(`[data-emotion="${data.emotion}"]`);
            if (currentEmotion) {
                currentEmotion.classList.add('active');
            }

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            prevBtn.disabled = currentStep === 0;
            nextBtn.disabled = currentStep === journeyData.length - 1;
            
            // æ ‡è®°èŠ‚ç‚¹ä¸ºå·²è®¿é—®
            visitedNodes.add(currentStep);
        }

        // ç§»åŠ¨å°äººè§’è‰²
        function moveCharacter() {
            const targetNode = nodes[currentStep];
            const nodeRect = targetNode.getBoundingClientRect();
            const mapRect = document.querySelector('.journey-map').getBoundingClientRect();
            
            const targetLeft = ((nodeRect.left - mapRect.left) / mapRect.width) * 100;
            const targetTop = ((nodeRect.top - mapRect.top) / mapRect.height) * 100;
            
            character.style.left = `${targetLeft - 3}%`;
            character.style.top = `${targetTop - 3}%`;
        }

        // æ˜¾ç¤ºè¯¦æƒ…å¼¹çª—
        function showDetailModal() {
            const data = journeyData[currentStep];
            modalTitle.textContent = data.title;
            
            modalBody.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <h4 style="color: #a8e6cf; margin-bottom: 8px;">ğŸ“– èƒŒæ™¯ä¿¡æ¯</h4>
                    <p style="line-height: 1.5; font-size: 0.9rem;">${data.detailedInfo.background}</p>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <h4 style="color: #f39c12; margin-bottom: 8px;">âš ï¸ ä¸»è¦æŒ‘æˆ˜</h4>
                    <ul style="padding-left: 15px; line-height: 1.5; font-size: 0.9rem;">
                        ${data.detailedInfo.challenges.map(challenge => `<li>${challenge}</li>`).join('')}
                    </ul>
                </div>
                
                ${data.detailedInfo.impact ? `
                <div style="margin-bottom: 15px;">
                    <h4 style="color: #e74c3c; margin-bottom: 8px;">ğŸ“Š å½±å“åˆ†æ</h4>
                    <p style="line-height: 1.5; font-size: 0.9rem;">${data.detailedInfo.impact}</p>
                </div>
                ` : ''}
                
                ${data.detailedInfo.materials ? `
                <div style="margin-bottom: 15px;">
                    <h4 style="color: #3498db; margin-bottom: 8px;">ğŸ“‹ æ‰€éœ€ææ–™</h4>
                    <ul style="padding-left: 15px; line-height: 1.5; font-size: 0.9rem;">
                        ${data.detailedInfo.materials.map(material => `<li>${material}</li>`).join('')}
                    </ul>
                </div>
                ` : ''}
                
                ${data.detailedInfo.opportunities ? `
                <div>
                    <h4 style="color: #27ae60; margin-bottom: 8px;">ğŸ’¡ æ”¹è¿›æœºä¼š</h4>
                    <ul style="padding-left: 15px; line-height: 1.5; font-size: 0.9rem;">
                        ${data.detailedInfo.opportunities.map(opp => `<li>${opp}</li>`).join('')}
                    </ul>
                </div>
                ` : ''}
            `;
            
            detailModal.classList.add('active');
        }

        // éšè—è¯¦æƒ…å¼¹çª—
        function hideDetailModal() {
            detailModal.classList.remove('active');
        }

        // å¯¼èˆªå‡½æ•°
        function nextStep() {
            if (currentStep < journeyData.length - 1) {
                currentStep++;
                updateDisplay();
            }
        }

        function prevStep() {
            if (currentStep > 0) {
                currentStep--;
                updateDisplay();
            }
        }

        function goToStep(step) {
            if (step >= 0 && step < journeyData.length) {
                currentStep = step;
                updateDisplay();
            }
        }

        function reset() {
            currentStep = 0;
            visitedNodes = new Set([0]);
            updateDisplay();
            if (autoPlayInterval) {
                clearInterval(autoPlayInterval);
                autoPlayInterval = null;
                autoPlayBtn.innerHTML = 'â–¶ï¸ è‡ªåŠ¨æ’­æ”¾';
            }
        }

        function toggleAutoPlay() {
            if (autoPlayInterval) {
                clearInterval(autoPlayInterval);
                autoPlayInterval = null;
                autoPlayBtn.innerHTML = 'â–¶ï¸ è‡ªåŠ¨æ’­æ”¾';
            } else {
                autoPlayInterval = setInterval(() => {
                    if (currentStep < journeyData.length - 1) {
                        nextStep();
                    } else {
                        clearInterval(autoPlayInterval);
                        autoPlayInterval = null;
                        autoPlayBtn.innerHTML = 'â–¶ï¸ è‡ªåŠ¨æ’­æ”¾';
                    }
                }, 4000);
                autoPlayBtn.innerHTML = 'â¸ï¸ åœæ­¢æ’­æ”¾';
            }
        }

        // åˆ›å»ºå¢å¼ºçš„ç²’å­æ•ˆæœ
        function createEnhancedParticles() {
            const particlesContainer = document.getElementById('particles');
            
            // åˆ›å»ºä¸åŒå¤§å°çš„ç²’å­
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                const size = Math.random() > 0.7 ? 'large' : (Math.random() > 0.4 ? 'medium' : 'small');
                particle.className = `particle ${size}`;
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 8 + 's';
                particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // é”®ç›˜å¯¼èˆªå¢å¼º
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowLeft':
                    e.preventDefault();
                    prevStep();
                    break;
                case 'ArrowRight':
                case ' ':
                    e.preventDefault();
                    nextStep();
                    break;
                case 'Home':
                    e.preventDefault();
                    reset();
                    break;
                case 'Enter':
                    e.preventDefault();
                    showDetailModal();
                    break;
                case 'Escape':
                    e.preventDefault();
                    hideDetailModal();
                    break;
            }
        });

        // åˆå§‹åŒ–å‡½æ•°
        function init() {
            updateDisplay();
            createEnhancedParticles();
            
            // æ·»åŠ èŠ‚ç‚¹ç‚¹å‡»äº‹ä»¶
            nodes.forEach((node, index) => {
                node.addEventListener('click', () => goToStep(index));
            });

            // æŒ‰é’®äº‹ä»¶ç»‘å®š
            prevBtn.addEventListener('click', prevStep);
            nextBtn.addEventListener('click', nextStep);
            resetBtn.addEventListener('click', reset);
            autoPlayBtn.addEventListener('click', toggleAutoPlay);
            detailBtn.addEventListener('click', showDetailModal);
            modalClose.addEventListener('click', hideDetailModal);

            // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
            detailModal.addEventListener('click', (e) => {
                if (e.target === detailModal) {
                    hideDetailModal();
                }
            });
        }

        // å¯åŠ¨åº”ç”¨
        init();
    </script>
</body>
</html>